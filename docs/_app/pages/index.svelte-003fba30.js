import{S as O,i as H,s as P,e as b,t as q,k as V,c as S,a as E,h as C,d,m as $,b as v,g as R,J as p,K as A,D as te,F as oe,L as me,M as ce,N as he,G as ie,H as ue,I as fe,q as B,o as T,j as de,O as W,P as L,Q as ee,R as _e,w as F,x as Z,y as G,B as J,T as ne,U as pe,v as ge,V as be}from"../chunks/vendor-688359be.js";function Se(n){let e,s,t,r,a,o,u;return{c(){e=b("header"),s=b("div"),t=b("div"),r=q("QR Scan Browser"),a=V(),o=b("div"),u=q("QR Code Scanner in the Browser"),this.h()},l(f){e=S(f,"HEADER",{class:!0});var c=E(e);s=S(c,"DIV",{class:!0});var i=E(s);t=S(i,"DIV",{class:!0});var l=E(t);r=C(l,"QR Scan Browser"),l.forEach(d),a=$(i),o=S(i,"DIV",{class:!0});var h=E(o);u=C(h,"QR Code Scanner in the Browser"),h.forEach(d),i.forEach(d),c.forEach(d),this.h()},h(){v(t,"class","header__title svelte-11a89w0"),v(o,"class","header__description svelte-11a89w0"),v(s,"class","header__text-container svelte-11a89w0"),v(e,"class","svelte-11a89w0")},m(f,c){R(f,e,c),p(e,s),p(s,t),p(t,r),p(s,a),p(s,o),p(o,u)},p:A,i:A,o:A,d(f){f&&d(e)}}}class we extends O{constructor(e){super();H(this,e,null,Se,P,{})}}function Ee(n){let e,s,t,r,a,o;return{c(){e=b("footer"),s=b("span"),t=q("Source-code available at"),r=V(),a=b("a"),o=q("peerpiper/qrcode-scanner-svelte"),this.h()},l(u){e=S(u,"FOOTER",{class:!0});var f=E(e);s=S(f,"SPAN",{class:!0});var c=E(s);t=C(c,"Source-code available at"),c.forEach(d),r=$(f),a=S(f,"A",{href:!0,class:!0,target:!0,rel:!0});var i=E(a);o=C(i,"peerpiper/qrcode-scanner-svelte"),i.forEach(d),f.forEach(d),this.h()},h(){v(s,"class","footer__text svelte-16ecrcd"),v(a,"href","http://github.com/peerpiper/qrcode-scanner-svelte"),v(a,"class","footer__project-link svelte-16ecrcd"),v(a,"target","_blank"),v(a,"rel","noopener noreferrer"),v(e,"class","svelte-16ecrcd")},m(u,f){R(u,e,f),p(e,s),p(s,t),p(e,r),p(e,a),p(a,o)},p:A,i:A,o:A,d(u){u&&d(e)}}}class De extends O{constructor(e){super();H(this,e,null,Ee,P,{})}}const X=te(null),Y=te(null),x=te(null);function ke(n){let e,s,t,r,a,o,u,f;return{c(){e=b("div"),s=b("div"),t=V(),r=b("div"),a=V(),o=b("div"),u=V(),f=b("div"),this.h()},l(c){e=S(c,"DIV",{});var i=E(e);s=S(i,"DIV",{class:!0}),E(s).forEach(d),t=$(i),r=S(i,"DIV",{class:!0}),E(r).forEach(d),a=$(i),o=S(i,"DIV",{class:!0}),E(o).forEach(d),u=$(i),f=S(i,"DIV",{class:!0}),E(f).forEach(d),i.forEach(d),this.h()},h(){v(s,"class","scanner-border scanner-border--top-left svelte-5ppqz9"),v(r,"class","scanner-border scanner-border--top-right svelte-5ppqz9"),v(o,"class","scanner-border scanner-border--bottom-left svelte-5ppqz9"),v(f,"class","scanner-border scanner-border--bottom-right svelte-5ppqz9")},m(c,i){R(c,e,i),p(e,s),p(e,t),p(e,r),p(e,a),p(e,o),p(e,u),p(e,f)},p:A,i:A,o:A,d(c){c&&d(e)}}}class ye extends O{constructor(e){super();H(this,e,null,ke,P,{})}}var Me="/qrcode-scanner-svelte/_app/assets/scan-edb9a96e.svg";const Ie=n=>({decodedData:n&1}),ae=n=>({decodedData:n[0]});function Ve(n){let e,s;return{c(){e=q(n[0]),s=q(";")},l(t){e=C(t,n[0]),s=C(t,";")},m(t,r){R(t,e,r),R(t,s,r)},p(t,r){r&1&&de(e,t[0])},d(t){t&&d(e),t&&d(s)}}}function $e(n){let e,s;return{c(){e=b("a"),s=q(n[0]),this.h()},l(t){e=S(t,"A",{class:!0,href:!0,target:!0,rel:!0});var r=E(e);s=C(r,n[0]),r.forEach(d),this.h()},h(){v(e,"class","results__link svelte-2uoird"),v(e,"href",n[0]),v(e,"target","_blank"),v(e,"rel","noopener noreferrer")},m(t,r){R(t,e,r),p(e,s)},p(t,r){r&1&&de(s,t[0]),r&1&&v(e,"href",t[0])},d(t){t&&d(e)}}}function Re(n){let e,s;return{c(){e=b("span"),s=q("Scan a QR Code to send data here."),this.h()},l(t){e=S(t,"SPAN",{class:!0});var r=E(e);s=C(r,"Scan a QR Code to send data here."),r.forEach(d),this.h()},h(){v(e,"class","results__empty svelte-2uoird")},m(t,r){R(t,e,r),p(e,s)},p:A,d(t){t&&d(e)}}}function Ne(n){let e,s,t,r,a,o,u,f,c,i,l,h,g;function U(w,y){var j;if(y&5&&(t=null),!w[0]||w[0]==="")return Re;if(t==null&&(t=!!((j=w[0])==null?void 0:j.match(w[2]))),t)return $e;if(w[0])return Ve}let I=U(n,-1),D=I&&I(n);return{c(){e=b("div"),s=b("div"),D&&D.c(),r=V(),a=b("div"),o=b("button"),u=b("img"),c=V(),i=b("span"),l=q("New Scan"),this.h()},l(w){e=S(w,"DIV",{class:!0});var y=E(e);s=S(y,"DIV",{class:!0});var j=E(s);D&&D.l(j),j.forEach(d),r=$(y),a=S(y,"DIV",{class:!0});var K=E(a);o=S(K,"BUTTON",{type:!0,class:!0});var Q=E(o);u=S(Q,"IMG",{class:!0,src:!0,alt:!0}),c=$(Q),i=S(Q,"SPAN",{});var z=E(i);l=C(z,"New Scan"),z.forEach(d),Q.forEach(d),K.forEach(d),y.forEach(d),this.h()},h(){v(s,"class","results__data svelte-2uoird"),v(u,"class","results__scan-icon svelte-2uoird"),me(u.src,f=Me)||v(u,"src",f),v(u,"alt","New Scan"),v(o,"type","button"),v(o,"class","results__button svelte-2uoird"),v(a,"class","results__button-container svelte-2uoird"),v(e,"class","results svelte-2uoird")},m(w,y){R(w,e,y),p(e,s),D&&D.m(s,null),p(e,r),p(e,a),p(a,o),p(o,u),p(o,c),p(o,i),p(i,l),h||(g=ce(o,"click",function(){he(n[1])&&n[1].apply(this,arguments)}),h=!0)},p(w,y){n=w,I===(I=U(n,y))&&D?D.p(n,y):(D&&D.d(1),D=I&&I(n),D&&(D.c(),D.m(s,null)))},d(w){w&&d(e),D&&D.d(),h=!1,g()}}}function Ue(n){let e;const s=n[5].default,t=oe(s,n,n[4],ae),r=t||Ne(n);return{c(){r&&r.c()},l(a){r&&r.l(a)},m(a,o){r&&r.m(a,o),e=!0},p(a,[o]){t?t.p&&(!e||o&17)&&ie(t,s,a,a[4],e?fe(s,a[4],o,Ie):ue(a[4]),ae):r&&r.p&&(!e||o&7)&&r.p(a,e?o:-1)},i(a){e||(B(r,a),e=!0)},o(a){T(r,a),e=!1},d(a){r&&r.d(a)}}}function Ae(n,e,s){let{$$slots:t={},$$scope:r}=e,{active:a}=e,{decodedData:o}=e,{onNewScan:u}=e,f;return n.$$set=c=>{"active"in c&&s(3,a=c.active),"decodedData"in c&&s(0,o=c.decodedData),"onNewScan"in c&&s(1,u=c.onNewScan),"$$scope"in c&&s(4,r=c.$$scope)},n.$$.update=()=>{if(n.$$.dirty&8&&a){const c=/https?:\/\/(www\.)?[-a-zA-Z0-9@:%._+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b([-a-zA-Z0-9()@:%_+.~#?&//=]*)/g;s(2,f=new RegExp(c))}},[o,u,f,a,r,t]}class je extends O{constructor(e){super();H(this,e,Ae,Ue,P,{active:3,decodedData:0,onNewScan:1})}}function qe(n,e,s){let t,r,a;W(n,X,c=>s(1,t=c)),W(n,Y,c=>s(2,r=c)),W(n,x,c=>s(3,a=c));const o=c=>c!==null&&"getTracks"in c;function u(c){console.log(`Setting status ${c}`),L(x,a=c,a)}return[()=>{L(X,t=null,t),L(Y,r=null,r),L(x,a="stopped",a);function c(g){console.log("Setting erro"),L(Y,r=g,r)}function i(g){console.log("Setting stream",{params:g}),L(X,t=g,t)}return{stopMediaStream:()=>{console.log("stopping media stream"),o(t)&&(t.getTracks().forEach(g=>{g.stop(),t.removeTrack(g)}),u("stopped"))},startMediaStream:()=>{u("pending"),navigator.mediaDevices.getUserMedia({audio:!1,video:{facingMode:"environment"}}).then(g=>{i(g),u("resolved")}).catch(g=>{c(g),u("rejected")})}}}]}class Ce extends O{constructor(e){super();H(this,e,qe,null,P,{useUserMedia:0})}get useUserMedia(){return this.$$.ctx[0]}}const Qe=n=>({result:n&1}),le=n=>({result:n[0]});function Be(n){let e,s;return e=new je({props:{active:n[0]!==null,decodedData:n[0],onNewScan:n[15]}}),{c(){F(e.$$.fragment)},l(t){Z(e.$$.fragment,t)},m(t,r){G(e,t,r),s=!0},p(t,r){const a={};r&1&&(a.active=t[0]!==null),r&1&&(a.decodedData=t[0]),r&1&&(a.onNewScan=t[15]),e.$set(a)},i(t){s||(B(e.$$.fragment,t),s=!0)},o(t){T(e.$$.fragment,t),s=!1},d(t){J(e,t)}}}function Te(n){let e,s,t,r,a,o,u,f,c,i,l,h,g,U,I,D,w,y,j;function K(_){n[12](_)}let Q={};n[2]!==void 0&&(Q.useUserMedia=n[2]),e=new Ce({props:Q}),ee.push(()=>_e(e,"useUserMedia",K)),i=new ye({});const z=n[11].default,m=oe(z,n,n[10],le),M=m||Be(n);return{c(){F(e.$$.fragment),t=V(),r=b("div"),a=b("div"),o=b("canvas"),u=V(),f=b("video"),c=V(),F(i.$$.fragment),l=V(),h=b("div"),g=b("div"),U=q("Scan a QR code with your camera to see what it says."),D=V(),M&&M.c(),this.h()},l(_){Z(e.$$.fragment,_),t=$(_),r=S(_,"DIV",{class:!0});var k=E(r);a=S(k,"DIV",{class:!0});var N=E(a);o=S(N,"CANVAS",{class:!0}),E(o).forEach(d),u=$(N),f=S(N,"VIDEO",{class:!0});var ve=E(f);ve.forEach(d),c=$(N),Z(i.$$.fragment,N),N.forEach(d),l=$(k),h=S(k,"DIV",{class:!0});var se=E(h);g=S(se,"DIV",{});var re=E(g);U=C(re,"Scan a QR code with your camera to see what it says."),re.forEach(d),se.forEach(d),k.forEach(d),D=$(_),M&&M.l(_),this.h()},h(){v(o,"class","scanner__canvas svelte-1jvnekp"),v(f,"class","scanner__video svelte-1jvnekp"),v(a,"class","scanner__aspect-ratio-container svelte-1jvnekp"),v(h,"class","scanner-tip svelte-1jvnekp"),v(r,"class",I=ne(`scanner ${n[3]?"":"scanner--hidden"}`)+" svelte-1jvnekp")},m(_,k){G(e,_,k),R(_,t,k),R(_,r,k),p(r,a),p(a,o),n[13](o),p(a,u),p(a,f),n[14](f),p(a,c),G(i,a,null),p(r,l),p(r,h),p(h,g),p(g,U),R(_,D,k),M&&M.m(_,k),w=!0,y||(j=ce(f,"canplay",n[5]),y=!0)},p(_,[k]){const N={};!s&&k&4&&(s=!0,N.useUserMedia=_[2],pe(()=>s=!1)),e.$set(N),(!w||k&8&&I!==(I=ne(`scanner ${_[3]?"":"scanner--hidden"}`)+" svelte-1jvnekp"))&&v(r,"class",I),m?m.p&&(!w||k&1025)&&ie(m,z,_,_[10],w?fe(z,_[10],k,Qe):ue(_[10]),le):M&&M.p&&(!w||k&1)&&M.p(_,w?k:-1)},i(_){w||(B(e.$$.fragment,_),B(i.$$.fragment,_),B(M,_),w=!0)},o(_){T(e.$$.fragment,_),T(i.$$.fragment,_),T(M,_),w=!1},d(_){J(e,_),_&&d(t),_&&d(r),n[13](null),n[14](null),J(i),_&&d(D),M&&M.d(_),y=!1,j()}}}function ze(n,e,s){let t,r,a,o;W(n,x,m=>s(8,r=m)),W(n,X,m=>s(9,a=m)),W(n,Y,m=>s(17,o=m));let{$$slots:u={},$$scope:f}=e,{result:c=null}=e,i=null,l=null,h,g,U,I;ge(async()=>{s(7,I=!0)});const D=m=>{s(0,c=m)},w=()=>{if(console.log("Starting capture"),l===null||l===null||i===null||i===null){console.log("problem");return}const m=l.getContext("2d");if(m===null){console.log("problem");return}const{width:M,height:_}=l;m.drawImage(i,0,0,M,_);const k=m.getImageData(0,0,M,_),N=be(k.data,M,_);N===null?(console.log("problem"),setTimeout(w,750)):(D(N.data),h(),s(1,i.srcObject=null,i))},y=()=>{console.log("canplay"),!(l===null||l===null||i===null||i===null)&&(s(4,l.width=i.videoWidth,l),s(4,l.height=i.videoHeight,l),o!==null||w())};function j(m){U=m,s(2,U)}function K(m){ee[m?"unshift":"push"](()=>{l=m,s(4,l)})}function Q(m){ee[m?"unshift":"push"](()=>{i=m,s(1,i),s(8,r),s(9,a)})}const z=()=>s(0,c=null);return n.$$set=m=>{"result"in m&&s(0,c=m.result),"$$scope"in m&&s(10,f=m.$$scope)},n.$$.update=()=>{n.$$.dirty&1&&s(3,t=!c),n.$$.dirty&132&&I&&s(6,{stopMediaStream:h,startMediaStream:g}=U(),g),n.$$.dirty&770&&r==="resolved"&&i!==null&&a&&(console.log("Resolve, stream"),s(1,i.srcObject=a,i),i.play().catch(console.error)),n.$$.dirty&328&&t&&r==="stopped"&&g()},[c,i,U,t,l,y,g,I,r,a,f,u,j,K,Q,z]}class Oe extends O{constructor(e){super();H(this,e,ze,Te,P,{result:0})}}function He(n){let e,s,t,r,a,o,u,f;e=new we({});function c(l){n[1](l)}let i={};return n[0]!==void 0&&(i.result=n[0]),r=new Oe({props:i}),ee.push(()=>_e(r,"result",c)),u=new De({}),{c(){F(e.$$.fragment),s=V(),t=b("main"),F(r.$$.fragment),o=V(),F(u.$$.fragment)},l(l){Z(e.$$.fragment,l),s=$(l),t=S(l,"MAIN",{});var h=E(t);Z(r.$$.fragment,h),h.forEach(d),o=$(l),Z(u.$$.fragment,l)},m(l,h){G(e,l,h),R(l,s,h),R(l,t,h),G(r,t,null),R(l,o,h),G(u,l,h),f=!0},p(l,[h]){const g={};!a&&h&1&&(a=!0,g.result=l[0],pe(()=>a=!1)),r.$set(g)},i(l){f||(B(e.$$.fragment,l),B(r.$$.fragment,l),B(u.$$.fragment,l),f=!0)},o(l){T(e.$$.fragment,l),T(r.$$.fragment,l),T(u.$$.fragment,l),f=!1},d(l){J(e,l),l&&d(s),l&&d(t),J(r),l&&d(o),J(u,l)}}}function Pe(n,e,s){let t;function r(a){t=a,s(0,t)}return[t,r]}class Fe extends O{constructor(e){super();H(this,e,Pe,He,P,{})}}function Ze(n){let e,s;return e=new Fe({}),{c(){F(e.$$.fragment)},l(t){Z(e.$$.fragment,t)},m(t,r){G(e,t,r),s=!0},p:A,i(t){s||(B(e.$$.fragment,t),s=!0)},o(t){T(e.$$.fragment,t),s=!1},d(t){J(e,t)}}}class Je extends O{constructor(e){super();H(this,e,null,Ze,P,{})}}export{Je as default};
