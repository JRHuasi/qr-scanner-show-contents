import{S as z,i as H,s as P,e as S,t as q,k as R,c as w,a as E,h as C,d,m as N,b as v,g as U,J as p,K as j,D as te,F as oe,L as he,M as ce,N as ge,G as ie,H as ue,I as fe,q as O,o as T,j as de,O as L,v as _e,P as K,Q as ee,R as pe,w as F,x as Z,y as G,B as W,T as ne,U as ve,V as be,W as Se}from"../chunks/vendor-099cc1ff.js";function we(n){let e,s,t,r,a,o,i;return{c(){e=S("header"),s=S("div"),t=S("div"),r=q("QR Scan Browser"),a=R(),o=S("div"),i=q("QR Code Scanner in the Browser"),this.h()},l(u){e=w(u,"HEADER",{class:!0});var f=E(e);s=w(f,"DIV",{class:!0});var l=E(s);t=w(l,"DIV",{class:!0});var c=E(t);r=C(c,"QR Scan Browser"),c.forEach(d),a=N(l),o=w(l,"DIV",{class:!0});var b=E(o);i=C(b,"QR Code Scanner in the Browser"),b.forEach(d),l.forEach(d),f.forEach(d),this.h()},h(){v(t,"class","header__title svelte-11a89w0"),v(o,"class","header__description svelte-11a89w0"),v(s,"class","header__text-container svelte-11a89w0"),v(e,"class","svelte-11a89w0")},m(u,f){U(u,e,f),p(e,s),p(s,t),p(t,r),p(s,a),p(s,o),p(o,i)},p:j,i:j,o:j,d(u){u&&d(e)}}}class Ee extends z{constructor(e){super();H(this,e,null,we,P,{})}}function De(n){let e,s,t,r,a,o;return{c(){e=S("footer"),s=S("span"),t=q("Source-code available at"),r=R(),a=S("a"),o=q("peerpiper/qrcode-scanner-svelte"),this.h()},l(i){e=w(i,"FOOTER",{class:!0});var u=E(e);s=w(u,"SPAN",{class:!0});var f=E(s);t=C(f,"Source-code available at"),f.forEach(d),r=N(u),a=w(u,"A",{href:!0,class:!0,target:!0,rel:!0});var l=E(a);o=C(l,"peerpiper/qrcode-scanner-svelte"),l.forEach(d),u.forEach(d),this.h()},h(){v(s,"class","footer__text svelte-16ecrcd"),v(a,"href","http://github.com/peerpiper/qrcode-scanner-svelte"),v(a,"class","footer__project-link svelte-16ecrcd"),v(a,"target","_blank"),v(a,"rel","noopener noreferrer"),v(e,"class","svelte-16ecrcd")},m(i,u){U(i,e,u),p(e,s),p(s,t),p(e,r),p(e,a),p(a,o)},p:j,i:j,o:j,d(i){i&&d(e)}}}class ke extends z{constructor(e){super();H(this,e,null,De,P,{})}}const X=te(null),Y=te(null),x=te(null);function Me(n){let e,s,t,r,a,o,i,u;return{c(){e=S("div"),s=S("div"),t=R(),r=S("div"),a=R(),o=S("div"),i=R(),u=S("div"),this.h()},l(f){e=w(f,"DIV",{});var l=E(e);s=w(l,"DIV",{class:!0}),E(s).forEach(d),t=N(l),r=w(l,"DIV",{class:!0}),E(r).forEach(d),a=N(l),o=w(l,"DIV",{class:!0}),E(o).forEach(d),i=N(l),u=w(l,"DIV",{class:!0}),E(u).forEach(d),l.forEach(d),this.h()},h(){v(s,"class","scanner-border scanner-border--top-left svelte-5ppqz9"),v(r,"class","scanner-border scanner-border--top-right svelte-5ppqz9"),v(o,"class","scanner-border scanner-border--bottom-left svelte-5ppqz9"),v(u,"class","scanner-border scanner-border--bottom-right svelte-5ppqz9")},m(f,l){U(f,e,l),p(e,s),p(e,t),p(e,r),p(e,a),p(e,o),p(e,i),p(e,u)},p:j,i:j,o:j,d(f){f&&d(e)}}}class ye extends z{constructor(e){super();H(this,e,null,Me,P,{})}}var Ie="/qrcode-scanner-svelte/_app/assets/scan-edb9a96e.svg";const Ve=n=>({decodedData:n&1}),ae=n=>({decodedData:n[0]});function Re(n){let e,s;return{c(){e=q(n[0]),s=q(";")},l(t){e=C(t,n[0]),s=C(t,";")},m(t,r){U(t,e,r),U(t,s,r)},p(t,r){r&1&&de(e,t[0])},d(t){t&&d(e),t&&d(s)}}}function Ne(n){let e,s;return{c(){e=S("a"),s=q(n[0]),this.h()},l(t){e=w(t,"A",{class:!0,href:!0,target:!0,rel:!0});var r=E(e);s=C(r,n[0]),r.forEach(d),this.h()},h(){v(e,"class","results__link svelte-2uoird"),v(e,"href",n[0]),v(e,"target","_blank"),v(e,"rel","noopener noreferrer")},m(t,r){U(t,e,r),p(e,s)},p(t,r){r&1&&de(s,t[0]),r&1&&v(e,"href",t[0])},d(t){t&&d(e)}}}function Ue(n){let e,s;return{c(){e=S("span"),s=q("Scan a QR Code to send data here."),this.h()},l(t){e=w(t,"SPAN",{class:!0});var r=E(e);s=C(r,"Scan a QR Code to send data here."),r.forEach(d),this.h()},h(){v(e,"class","results__empty svelte-2uoird")},m(t,r){U(t,e,r),p(e,s)},p:j,d(t){t&&d(e)}}}function je(n){let e,s,t,r,a,o,i,u,f,l,c,b,h;function g(D,y){var A;if(y&5&&(t=null),!D[0]||D[0]==="")return Ue;if(t==null&&(t=!!((A=D[0])==null?void 0:A.match(D[2]))),t)return Ne;if(D[0])return Re}let V=g(n,-1),k=V&&V(n);return{c(){e=S("div"),s=S("div"),k&&k.c(),r=R(),a=S("div"),o=S("button"),i=S("img"),f=R(),l=S("span"),c=q("New Scan"),this.h()},l(D){e=w(D,"DIV",{class:!0});var y=E(e);s=w(y,"DIV",{class:!0});var A=E(s);k&&k.l(A),A.forEach(d),r=N(y),a=w(y,"DIV",{class:!0});var J=E(a);o=w(J,"BUTTON",{type:!0,class:!0});var Q=E(o);i=w(Q,"IMG",{class:!0,src:!0,alt:!0}),f=N(Q),l=w(Q,"SPAN",{});var m=E(l);c=C(m,"New Scan"),m.forEach(d),Q.forEach(d),J.forEach(d),y.forEach(d),this.h()},h(){v(s,"class","results__data svelte-2uoird"),v(i,"class","results__scan-icon svelte-2uoird"),he(i.src,u=Ie)||v(i,"src",u),v(i,"alt","New Scan"),v(o,"type","button"),v(o,"class","results__button svelte-2uoird"),v(a,"class","results__button-container svelte-2uoird"),v(e,"class","results svelte-2uoird")},m(D,y){U(D,e,y),p(e,s),k&&k.m(s,null),p(e,r),p(e,a),p(a,o),p(o,i),p(o,f),p(o,l),p(l,c),b||(h=ce(o,"click",function(){ge(n[1])&&n[1].apply(this,arguments)}),b=!0)},p(D,y){n=D,V===(V=g(n,y))&&k?k.p(n,y):(k&&k.d(1),k=V&&V(n),k&&(k.c(),k.m(s,null)))},d(D){D&&d(e),k&&k.d(),b=!1,h()}}}function Ae(n){let e;const s=n[5].default,t=oe(s,n,n[4],ae),r=t||je(n);return{c(){r&&r.c()},l(a){r&&r.l(a)},m(a,o){r&&r.m(a,o),e=!0},p(a,[o]){t?t.p&&(!e||o&17)&&ie(t,s,a,a[4],e?fe(s,a[4],o,Ve):ue(a[4]),ae):r&&r.p&&(!e||o&7)&&r.p(a,e?o:-1)},i(a){e||(O(r,a),e=!0)},o(a){T(r,a),e=!1},d(a){r&&r.d(a)}}}function qe(n,e,s){let{$$slots:t={},$$scope:r}=e,{active:a}=e,{decodedData:o}=e,{onNewScan:i}=e,u;return n.$$set=f=>{"active"in f&&s(3,a=f.active),"decodedData"in f&&s(0,o=f.decodedData),"onNewScan"in f&&s(1,i=f.onNewScan),"$$scope"in f&&s(4,r=f.$$scope)},n.$$.update=()=>{if(n.$$.dirty&8&&a){const f=/https?:\/\/(www\.)?[-a-zA-Z0-9@:%._+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b([-a-zA-Z0-9()@:%_+.~#?&//=]*)/g;s(2,u=new RegExp(f))}},[o,i,u,a,r,t]}class Ce extends z{constructor(e){super();H(this,e,qe,Ae,P,{active:3,decodedData:0,onNewScan:1})}}function Qe(n,e,s){let t,r,a;L(n,X,l=>s(2,t=l)),L(n,Y,l=>s(3,r=l)),L(n,x,l=>s(4,a=l)),_e(()=>()=>{console.log("stop Component destroyed")});const o=l=>l!==null&&"getTracks"in l;function i(l){console.log(`Setting status ${l}`),K(x,a=l,a)}const u=()=>{K(X,t=null,t),K(Y,r=null,r),K(x,a="stopped",a);function l(g){console.log("Setting erro"),K(Y,r=g,r)}function c(g){console.log("Setting stream",{params:g}),K(X,t=g,t)}return{stopMediaStream:f,startMediaStream:()=>{i("pending"),navigator.mediaDevices.getUserMedia({audio:!1,video:{facingMode:"environment"}}).then(g=>{c(g),i("resolved")}).catch(g=>{l(g),i("rejected")})}}};function f(){console.log("stopping media stream"),o(t)&&(t.getTracks().forEach(l=>{l.stop(),t.removeTrack(l)}),console.log({streams:t}),i("stopped"))}return[u]}class Be extends z{constructor(e){super();H(this,e,Qe,null,P,{useUserMedia:0})}get useUserMedia(){return this.$$.ctx[0]}}const Oe=n=>({result:n&1}),le=n=>({result:n[0]});function Te(n){let e,s;return e=new Ce({props:{active:n[0]!==null,decodedData:n[0],onNewScan:n[15]}}),{c(){F(e.$$.fragment)},l(t){Z(e.$$.fragment,t)},m(t,r){G(e,t,r),s=!0},p(t,r){const a={};r&1&&(a.active=t[0]!==null),r&1&&(a.decodedData=t[0]),r&1&&(a.onNewScan=t[15]),e.$set(a)},i(t){s||(O(e.$$.fragment,t),s=!0)},o(t){T(e.$$.fragment,t),s=!1},d(t){W(e,t)}}}function $e(n){let e,s,t,r,a,o,i,u,f,l,c,b,h,g,V,k,D,y,A;function J(_){n[12](_)}let Q={};n[4]!==void 0&&(Q.useUserMedia=n[4]),e=new Be({props:Q}),ee.push(()=>pe(e,"useUserMedia",J)),l=new ye({});const m=n[11].default,$=oe(m,n,n[10],le),I=$||Te(n);return{c(){F(e.$$.fragment),t=R(),r=S("div"),a=S("div"),o=S("canvas"),i=R(),u=S("video"),f=R(),F(l.$$.fragment),c=R(),b=S("div"),h=S("div"),g=q("Scan a QR code with your camera to see what it says."),k=R(),I&&I.c(),this.h()},l(_){Z(e.$$.fragment,_),t=N(_),r=w(_,"DIV",{class:!0});var M=E(r);a=w(M,"DIV",{class:!0});var B=E(a);o=w(B,"CANVAS",{class:!0}),E(o).forEach(d),i=N(B),u=w(B,"VIDEO",{class:!0});var me=E(u);me.forEach(d),f=N(B),Z(l.$$.fragment,B),B.forEach(d),c=N(M),b=w(M,"DIV",{class:!0});var se=E(b);h=w(se,"DIV",{});var re=E(h);g=C(re,"Scan a QR code with your camera to see what it says."),re.forEach(d),se.forEach(d),M.forEach(d),k=N(_),I&&I.l(_),this.h()},h(){v(o,"class","scanner__canvas svelte-1jvnekp"),v(u,"class","scanner__video svelte-1jvnekp"),v(a,"class","scanner__aspect-ratio-container svelte-1jvnekp"),v(b,"class","scanner-tip svelte-1jvnekp"),v(r,"class",V=ne(`scanner ${n[2]?"":"scanner--hidden"}`)+" svelte-1jvnekp")},m(_,M){G(e,_,M),U(_,t,M),U(_,r,M),p(r,a),p(a,o),n[13](o),p(a,i),p(a,u),n[14](u),p(a,f),G(l,a,null),p(r,c),p(r,b),p(b,h),p(h,g),U(_,k,M),I&&I.m(_,M),D=!0,y||(A=ce(u,"canplay",n[5]),y=!0)},p(_,[M]){const B={};!s&&M&16&&(s=!0,B.useUserMedia=_[4],ve(()=>s=!1)),e.$set(B),(!D||M&4&&V!==(V=ne(`scanner ${_[2]?"":"scanner--hidden"}`)+" svelte-1jvnekp"))&&v(r,"class",V),$?$.p&&(!D||M&1025)&&ie($,m,_,_[10],D?fe(m,_[10],M,Oe):ue(_[10]),le):I&&I.p&&(!D||M&1)&&I.p(_,D?M:-1)},i(_){D||(O(e.$$.fragment,_),O(l.$$.fragment,_),O(I,_),D=!0)},o(_){T(e.$$.fragment,_),T(l.$$.fragment,_),T(I,_),D=!1},d(_){W(e,_),_&&d(t),_&&d(r),n[13](null),n[14](null),W(l),_&&d(k),I&&I.d(_),y=!1,A()}}}function ze(n,e,s){let t,r,a,o;L(n,x,m=>s(8,r=m)),L(n,X,m=>s(9,a=m)),L(n,Y,m=>s(17,o=m));let{$$slots:i={},$$scope:u}=e,{result:f=null}=e,{stopMediaStream:l=null}=e,c;const b=be();let h=null,g=null,V;_e(()=>(s(6,{stopMediaStream:l,startMediaStream:c}=V(),l,s(7,c)),()=>{console.log("Component destroyed"),l(),s(1,h.srcObject=null,h)}));const k=()=>{if(!g||!h)return;const m=g.getContext("2d");if(!m)return;const{width:$,height:I}=g;m.drawImage(h,0,0,$,I);const _=m.getImageData(0,0,$,I),M=Se(_.data,$,I);M===null?(console.log("timeout"),setTimeout(k,750)):(s(0,f=M.data),b("successfulScan",M.data),l(),s(1,h.srcObject=null,h))},D=()=>{console.log("canplay"),!(g===null||g===null||h===null||h===null)&&(s(3,g.width=h.videoWidth,g),s(3,g.height=h.videoHeight,g),o!==null||k())};function y(m){V=m,s(4,V)}function A(m){ee[m?"unshift":"push"](()=>{g=m,s(3,g)})}function J(m){ee[m?"unshift":"push"](()=>{h=m,s(1,h),s(8,r),s(9,a)})}const Q=()=>s(0,f=null);return n.$$set=m=>{"result"in m&&s(0,f=m.result),"stopMediaStream"in m&&s(6,l=m.stopMediaStream),"$$scope"in m&&s(10,u=m.$$scope)},n.$$.update=()=>{n.$$.dirty&1&&s(2,t=!f),n.$$.dirty&770&&r==="resolved"&&h!==null&&a&&(console.log("Resolve, stream"),s(1,h.srcObject=a,h),h.play().catch(console.error)),n.$$.dirty&388&&t&&r==="stopped"&&c&&c()},[f,h,t,g,V,D,l,c,r,a,u,i,y,A,J,Q]}class He extends z{constructor(e){super();H(this,e,ze,$e,P,{result:0,stopMediaStream:6})}}function Pe(n){let e,s,t,r,a,o,i,u;e=new Ee({});function f(c){n[1](c)}let l={};return n[0]!==void 0&&(l.result=n[0]),r=new He({props:l}),ee.push(()=>pe(r,"result",f)),i=new ke({}),{c(){F(e.$$.fragment),s=R(),t=S("main"),F(r.$$.fragment),o=R(),F(i.$$.fragment)},l(c){Z(e.$$.fragment,c),s=N(c),t=w(c,"MAIN",{});var b=E(t);Z(r.$$.fragment,b),b.forEach(d),o=N(c),Z(i.$$.fragment,c)},m(c,b){G(e,c,b),U(c,s,b),U(c,t,b),G(r,t,null),U(c,o,b),G(i,c,b),u=!0},p(c,[b]){const h={};!a&&b&1&&(a=!0,h.result=c[0],ve(()=>a=!1)),r.$set(h)},i(c){u||(O(e.$$.fragment,c),O(r.$$.fragment,c),O(i.$$.fragment,c),u=!0)},o(c){T(e.$$.fragment,c),T(r.$$.fragment,c),T(i.$$.fragment,c),u=!1},d(c){W(e,c),c&&d(s),c&&d(t),W(r),c&&d(o),W(i,c)}}}function Fe(n,e,s){let t;function r(a){t=a,s(0,t)}return[t,r]}class Ze extends z{constructor(e){super();H(this,e,Fe,Pe,P,{})}}function Ge(n){let e,s;return e=new Ze({}),{c(){F(e.$$.fragment)},l(t){Z(e.$$.fragment,t)},m(t,r){G(e,t,r),s=!0},p:j,i(t){s||(O(e.$$.fragment,t),s=!0)},o(t){T(e.$$.fragment,t),s=!1},d(t){W(e,t)}}}class Je extends z{constructor(e){super();H(this,e,null,Ge,P,{})}}export{Je as default};
